!function(t){t.fn.flowList=function(i){function a(a){function h(){o=g.find(">li"),e=o.length,s=g.parent().width(),r=o.eq(0).outerWidth(),n=o.eq(0).outerHeight(),f=Math.floor((s+i.gap)/(r+i.gap)),l=!1,d=[]}function v(){g.css({width:s}),o.last().find(".flow-arrow").remove(),o.removeClass("odd").removeClass("even").removeClass("last");for(var t=0;t<e;t++)t%f==0&&(l=!l),l?d.push([t%f*(r+i.gap),Math.floor(t/f)*(n+i.vGap),"even"]):d.push([(f-1-t%f)*(r+i.gap),Math.floor(t/f)*(n+i.vGap),"odd"]);for(var t=0;t<e;t++)o.eq(t).css({position:"absolute",left:d[t][0],top:d[t][1],margin:0}).attr("even-odd",d[t][2]).addClass(d[t][2]);g.find(".odd").prev(".even").addClass("last"),g.find(".even").prev(".odd").addClass("last")}function c(){var t=g.find(".flow-box").css("border-right-width");o.filter(".last").find(".flow-arrow").removeAttr("style"),o.filter(".last").find(".flow-arrow").css({height:i.vGap,width:i.vGap,"margin-top":t}),o.filter(".even:not(.last)").find(".flow-arrow").css({right:-i.gap-parseInt(t),left:"auto",width:i.gap}),o.filter(".odd:not(.last)").find(".flow-arrow").css({right:"auto",left:-i.gap-parseInt(t),width:i.gap})}function p(){g.css({width:e>f-1?d[f-1][0]+r:d[e-1][0]+r,height:d[e-1][1]+n,visibility:"visible"})}function u(){h(),v(),c(),p()}function w(){var i=-1;g.find(".flow-box").each(function(a,o){t(this).height()>i&&(i=t(this).outerHeight())}),g.find(".flow-box").css("height",i)}var g=a;i.url?t.ajax({url:i.url,type:"GET",dataType:"json",success:function(t){if(!g.attr("finished")){var a=t.data;g.empty();for(var o=0;o<a.length;o++){var e=i.format(a,o);g.append(e)}g.attr("finished",!0)}u(),w()}}):u()}var o,e,s,r,n,f,l,d,h={gap:60,vGap:30,format:function(t,i){return'<li class="flow-box '+t[i].addClass+'"><div class="flow-text" title="'+t[i].title+'">'+t[i].text+'</div><div class="flow-arrow"><div class="'+t[i].arrowClass+'"></div></div></li>'}},i=t.extend({},h,i),v=this;v.each(function(){a(t(this))}),t(window).resize(function(i){v.each(function(){a(t(this))})})}}(jQuery);